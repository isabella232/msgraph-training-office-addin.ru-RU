---
ms.openlocfilehash: 89bc4baff47ae895c7c0dfd34a8f8d4d0da091f5
ms.sourcegitcommit: 8a65c826f6b229c287a782d784b6d9629aa5a3d0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/20/2021
ms.locfileid: "51899439"
---
<!-- markdownlint-disable MD002 MD041 -->

В этом упражнении будет создаваться новая регистрация веб-приложений Azure AD с помощью центра администрирования Azure Active Directory.

1. Откройте браузер и перейдите в [Центр администрирования Azure Active Directory](https://aad.portal.azure.com). Войдите с помощью **личной учетной записи** (т.е. учетной записи Microsoft) или **рабочей (учебной) учетной записи**.

1. Выберите **Azure Active Directory** на панели навигации слева, затем выберите **Регистрация приложений** в разделе **Управление**.

    ![Снимок экрана регистрации приложения ](images/app-registrations.png)

1. Выберите **Новая регистрация**. На странице **Зарегистрировать приложение** задайте необходимые значения следующим образом.

    - Введите **имя** `Office Add-in Graph Tutorial`.
    - Введите **поддерживаемые типы учетных записей** для **учетных записей в любом каталоге организаций и личных учетных записей Microsoft**.
    - В разделе **URI адрес перенаправления** введите значение в первом раскрывающемся списке `Single-page application (SPA)` и задайте значение `https://localhost:3000/consent.html`.

    ![Снимок экрана со страницей регистрации приложения](images/register-an-app.png)

1. Нажмите **Зарегистрировать**. На странице **Учебник по** надстройке Office скопируйте значение ID приложения **(клиента)** и сохраните его, оно потребуется на следующем шаге.

    ![Снимок экрана с идентификатором приложения для новой регистрации](images/application-id.png)

1. Выберите пункт **Проверка подлинности** в разделе **Управление**. Найдите **раздел Неявный грант** и впускаем **маркеры Access** и **маркеры ID.** Нажмите **Сохранить**.

    ![Снимок экрана: раздел "Неявное предоставление разрешения"](./images/aad-implicit-grant.png)

1. Выберите **Сертификаты и секреты** в разделе **Управление**. Нажмите кнопку **Новый секрет клиента**. Введите значение в поле **Описание**, выберите один из параметров **Срок действия** и нажмите **Добавить**.

1. Скопируйте значение секрета клиента, а затем покиньте эту страницу. Оно вам понадобится на следующем шаге.

    > [!IMPORTANT]
    > Это секрет клиента, он никогда не отображается еще раз, поэтому убедитесь, что вы скопировали его.

1. Выберите **разрешения API в** статье **Управление,** а затем **добавьте разрешение.**

1. Выберите **Microsoft Graph,** затем **делегирование разрешений.**

1. Выберите следующие разрешения, а затем **добавьте разрешения.**

    - **offline_access** — это позволит приложению обновить маркеры доступа по истечении срока действия.
    - **Calendars.ReadWrite** — это позволит приложению читать и писать в календарь пользователя.
    - **MailboxSettings.Read** — это позволит приложению получать часовой пояс пользователя из параметров почтовых ящиков.

    ![Снимок экрана настроенных разрешений](images/configured-permissions.png)

## <a name="configure-office-add-in-single-sign-on"></a>Настройка единого входного знака Надстройки Office

В этом разделе вы обновим регистрацию приложения для поддержки единого входного знака [Office Add-in (SSO).](https://docs.microsoft.com/office/dev/add-ins/develop/sso-in-office-add-ins)

1. Выберите **Expose aPI**. В **области, определенные этим разделом API,** выберите **Добавить область**. При запросе на набор **URI ID** приложения задай значение `api://localhost:3000/YOUR_APP_ID_HERE` , заменив его `YOUR_APP_ID_HERE` ИД приложения. Выберите **Сохранить и продолжить**.

1. Заполните поля следующим образом и выберите **область Добавить**.

    - **Имя области:**`access_as_user`
    - **Кто может дать согласие?: Администраторы и пользователи**
    - **Имя отображения согласия администратора:**`Access the app as the user`
    - **Описание согласия администратора:**`Allows Office Add-ins to call the app's web APIs as the current user.`
    - **Имя отображения согласия пользователя:**`Access the app as you`
    - **Описание согласия пользователя:**`Allows Office Add-ins to call the app's web APIs as you.`
    - **Состояние: Включено**

    ![Снимок экрана формы Добавить область](images/add-scope.png)

1. В разделе **Авторизованные клиентские приложения** выберите **Добавление клиентского приложения.** Введите клиентский ИД из следующего списка, введите область в уполномоченных сферах **и** выберите **приложение Добавить.** Повторите этот процесс для каждого из клиентских ИД в списке.

    - `d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office).
    - `ea5a67f6-b6f3-4338-b240-c655ddc3cc8e` (Microsoft Office).
    - `57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office в Интернете).
    - `08e18876-6177-487e-b8b5-cf950c1e598c` (Office в Интернете).

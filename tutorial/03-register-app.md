---
ms.openlocfilehash: a336095a238eefeae22dac86d29e3140e8d94bf1
ms.sourcegitcommit: 24bb4b3df6a035806a58b609e1d8078ac5505fa1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/17/2021
ms.locfileid: "50274337"
---
<!-- markdownlint-disable MD002 MD041 -->

В этом упражнении вы создайте регистрацию нового веб-приложения Azure AD с помощью Центра администрирования Azure Active Directory.

1. Откройте браузер и перейдите к [Центру администрирования Azure Active Directory](https://aad.portal.azure.com). Войдите с помощью **личной учетной записи** (т.е. учетной записи Microsoft) или **рабочей (учебной) учетной записи**.

1. Выберите **Azure Active Directory** на панели навигации слева, затем выберите **Регистрация приложений** в разделе **Управление**.

    ![Снимок экрана с регистрацией приложений ](images/app-registrations.png)

1. Выберите **Новая регистрация**. На странице **Зарегистрировать приложение** задайте необходимые значения следующим образом.

    - Введите **имя** `Office Add-in Graph Tutorial`.
    - Введите **поддерживаемые типы учетных записей** для **учетных записей в любом каталоге организаций и личных учетных записей Microsoft**.
    - В разделе **URI адрес перенаправления** введите значение в первом раскрывающемся списке `Single-page application (SPA)` и задайте значение `https://localhost:3000/consent.html`.

    ![Снимок экрана: страница "Регистрация приложения"](images/register-an-app.png)

1. Нажмите **Зарегистрировать**. На странице **учебника по Graph** для надстройки Office скопируйте значение ИД приложения **(клиента)** и сохраните его, оно потребуется вам на следующем этапе.

    ![Снимок экрана: ИД нового приложения для регистрации](images/application-id.png)

1. Выберите **Сертификаты и секреты** в разделе **Управление**. Нажмите кнопку **Новый секрет клиента**. Введите значение в **описании** и выберите один из параметров **"Срок действия истекает"** и выберите **"Добавить".**

1. Скопируйте значение секрета клиента, а затем покиньте эту страницу. Оно вам понадобится на следующем шаге.

    > [!IMPORTANT]
    > Это секрет клиента, он никогда не отображается еще раз, поэтому убедитесь, что вы скопировали его.

1. Выберите **разрешения API в** области **"Управление",** а затем **выберите "Добавить разрешение".**

1. Выберите **Microsoft Graph,** а затем **делегирование разрешений.**

1. Выберите следующие разрешения, а затем выберите **"Добавить разрешения".**

    - **offline_access** — это позволит приложению обновлять маркеры доступа по истечении срока их действия.
    - **Calendars.ReadWrite** — позволяет приложению читать и записывать данные в календарь пользователя.
    - **MailboxSettings.Read** — позволяет приложению получить часовой пояс пользователя из параметров почтового ящика.

    ![Снимок экрана с настроенными разрешениями](images/configured-permissions.png)

## <a name="configure-office-add-in-single-sign-on"></a>Настройка единого входов для надстройки Office

В этом разделе вы обновим регистрацию приложения, чтобы поддерживать единый вход для [надстройки Office.](https://docs.microsoft.com/office/dev/add-ins/develop/sso-in-office-add-ins)

1. Выберите **"Показать API"**. В разделе **"Области", определяемом этим API,** выберите **"Добавить область".** Когда вам будет предложено установить **URI** для ИД приложения, установите значение , заменив его `api://localhost:3000/YOUR_APP_ID_HERE` на `YOUR_APP_ID_HERE` ИД приложения. Choose **Save and continue**.

1. Заполните поля следующим образом и выберите **"Добавить область".**

    - **Имя области:**`access_as_user`
    - **Кто может дать согласие?: администраторы и пользователи**
    - **Отображаемая имя согласия администратора:**`Access the app as the user`
    - **Описание согласия администратора:**`Allows Office Add-ins to call the app's web APIs as the current user.`
    - **Отображаемая имя согласия пользователя:**`Access the app as you`
    - **Описание согласия пользователя:**`Allows Office Add-ins to call the app's web APIs as you.`
    - **Состояние: включено**

    ![Снимок экрана с формой "Добавление области"](images/add-scope.png)

1. В разделе **"Авторизованные клиентские приложения"** выберите **"Добавить клиентские приложения".** Введите ИД клиента из следующего списка, введите область в разрешенных разрешениях и выберите **"Добавить приложение".** Повторите этот процесс для каждого из клиентских ИД в списке.

    - `d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office).
    - `ea5a67f6-b6f3-4338-b240-c655ddc3cc8e` (Microsoft Office).
    - `57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office в Интернете).
    - `08e18876-6177-487e-b8b5-cf950c1e598c` (Office в Интернете).

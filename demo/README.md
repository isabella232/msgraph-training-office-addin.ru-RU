---
ms.openlocfilehash: fed56663591ac36e4defcae3a8d0a222f86e3026
ms.sourcegitcommit: 24bb4b3df6a035806a58b609e1d8078ac5505fa1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/17/2021
ms.locfileid: "50274370"
---
# <a name="how-to-run-the-completed-project"></a>Как запустить завершенный проект

## <a name="prerequisites"></a>Необходимые компоненты

Чтобы запустить завершенный проект в этой папке, необходимо следующее:

- [Node.js](https://nodejs.org) [и Yarn,](https://yarnpkg.com/) установленные на компьютере для разработки. (**Примечание.** Это руководство было написано на node версии 14.15.0 и Yarn версии 1.22.0. Действия в этом руководстве могут работать с другими версиями, но не были протестированы.)
- Личная учетная запись Майкрософт с почтовым ящиком Outlook.com или учетная запись Майкрософт для работы или учебного заведения.

Если у вас нет учетной записи Майкрософт, существует несколько вариантов получения бесплатной учетной записи:

- Вы можете [зарегистрироваться для новой личной учетной записи Майкрософт.](https://signup.live.com/signup?wa=wsignin1.0&rpsnv=12&ct=1454618383&rver=6.4.6456.0&wp=MBI_SSL_SHARED&wreply=https://mail.live.com/default.aspx&id=64855&cbcxt=mai&bk=1454618383&uiflavor=web&uaid=b213a65b4fdc484382b6622b3ecaa547&mkt=E-US&lc=1033&lic=1)
- Вы можете зарегистрироваться в программе для разработчиков [Office 365,](https://developer.microsoft.com/office/dev-program) чтобы получить бесплатную подписку на Office 365.

## <a name="register-a-web-application-with-the-azure-active-directory-admin-center"></a>Регистрация веб-приложения в Центре администрирования Azure Active Directory

1. Откройте браузер и перейдите к [Центру администрирования Azure Active Directory](https://aad.portal.azure.com). Войдите с помощью **личной учетной записи** (т.е. учетной записи Microsoft) или **рабочей (учебной) учетной записи**.

1. Выберите **Azure Active Directory** на панели навигации слева, затем выберите **Регистрация приложений** в разделе **Управление**.

    ![Снимок экрана с регистрацией приложений ](/tutorial/images/app-registrations.png)

1. Выберите **Новая регистрация**. На странице **Зарегистрировать приложение** задайте необходимые значения следующим образом.

    - Введите **имя** `Office Add-in Graph Tutorial`.
    - Введите **поддерживаемые типы учетных записей** для **учетных записей в любом каталоге организаций и личных учетных записей Microsoft**.
    - В разделе **URI адрес перенаправления** введите значение в первом раскрывающемся списке `Single-page application (SPA)` и задайте значение `https://localhost:3000/consent.html`.

    ![Снимок экрана: страница "Регистрация приложения"](/tutorial/images/register-an-app.png)

1. Нажмите **Зарегистрировать**. На странице **учебника по Graph** для надстройки Office скопируйте значение ИД приложения **(клиента)** и сохраните его, оно потребуется вам на следующем этапе.

    ![Снимок экрана: ИД нового приложения для регистрации](/tutorial/images/application-id.png)

1. Выберите **Сертификаты и секреты** в разделе **Управление**. Нажмите кнопку **Новый секрет клиента**. Введите значение в **описании** и выберите один из параметров **"Срок действия истекает"** и выберите **"Добавить".**

1. Скопируйте значение секрета клиента, а затем покиньте эту страницу. Оно вам понадобится на следующем шаге.

    > [!IMPORTANT]
    > Это секрет клиента, он никогда не отображается еще раз, поэтому убедитесь, что вы скопировали его.

1. Выберите **разрешения API в** области **"Управление",** а затем **выберите "Добавить разрешение".**

1. Выберите **Microsoft Graph,** а затем **делегирование разрешений.**

1. Выберите следующие разрешения, а затем выберите **"Добавить разрешения".**

    - **Calendars.ReadWrite** — позволяет приложению читать и записывать данные в календарь пользователя.
    - **MailboxSettings.Read** — позволяет приложению получить часовой пояс пользователя из параметров почтового ящика.

    ![Снимок экрана с настроенными разрешениями](/tutorial/images/configured-permissions.png)

## <a name="configure-office-add-in-single-sign-on"></a>Настройка единого входов для надстройки Office

Обновив регистрацию приложения для поддержки единого входов [(SSO) надстройки Office.](https://docs.microsoft.com/office/dev/add-ins/develop/sso-in-office-add-ins)

1. Выберите **"Показать API"**. В разделе **"Области", определяемом этим API,** выберите **"Добавить область".** Когда вам будет предложено установить **URI** для ИД приложения, установите значение , заменив его `api://localhost:3000/YOUR_APP_ID_HERE` на `YOUR_APP_ID_HERE` ИД приложения. Choose **Save and continue**.

1. Заполните поля следующим образом и выберите **"Добавить область".**

    - **Имя области:**`access_as_user`
    - **Кто может дать согласие?: администраторы и пользователи**
    - **Отображаемая имя согласия администратора:**`Access the app as the user`
    - **Описание согласия администратора:**`Allows Office Add-ins to call the app's web APIs as the current user.`
    - **Отображаемая имя согласия пользователя:**`Access the app as you`
    - **Описание согласия пользователя:**`Allows Office Add-ins to call the app's web APIs as you.`
    - **Состояние: включено**

    ![Снимок экрана с формой "Добавление области"](/tutorial/images/add-scope.png)

1. В разделе **"Авторизованные клиентские приложения"** выберите **"Добавить клиентские приложения".** Введите ИД клиента из следующего списка, введите область в разрешенных разрешениях и выберите **"Добавить приложение".** Повторите этот процесс для каждого из клиентских ИД в списке.

    - `d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office).
    - `ea5a67f6-b6f3-4338-b240-c655ddc3cc8e` (Microsoft Office).
    - `57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office в Интернете).
    - `08e18876-6177-487e-b8b5-cf950c1e598c` (Office в Интернете).

## <a name="install-development-certificates"></a>Установка сертификатов разработки

1. Чтобы создать и установить сертификаты разработки для надстройки, запустите следующую команду.

    ```Shell
    npx office-addin-dev-certs install
    ```

    Если вам будет предложено подтвердить, подтвердит действия. После выполнения команды вы увидите выходные данные, похожие на следующие.

    ```Shell
    You now have trusted access to https://localhost.
    Certificate: <path>\localhost.crt
    Key: <path>\localhost.key
    ```

1. Скопируйте пути к localhost.crt и localhost.key, они вам потребуется на следующем этапе.

## <a name="update-the-manifest"></a>Обновление манифеста

1. Откройте файл **manifest.xml** и внести следующие изменения.
    1. Замените `NEW_GUID_HERE` новым GUID, например `b4fa03b8-1eb6-4e8b-a380-e0476be9e019` .
    1. Замените все экземпляры `YOUR_APP_ID_HERE` на ИД приложения из регистрации приложения.

## <a name="configure-the-sample"></a>Настройка примера

1. Переименуем `example.env` файл в `.env` .
1. `.env`Отредактируете файл и внести следующие изменения.
    1. `YOUR_APP_ID_HERE`Замените **ид приложения,** который вы получили с портала регистрации приложений.
    1. Замените `YOUR_CLIENT_SECRET_HERE` секрет клиента, который вы получили с портала регистрации приложений.
    1. Замените `PATH_TO_LOCALHOST.CRT` путь к файлу localhost.crt из выходных данных `npx office-addin-dev-certs install` команды.
    1. Замените `PATH_TO_LOCALHOST.KEY` путь к файлу localhost.key из выходных данных `npx office-addin-dev-certs install` команды.

1. Переименуем `config.example.js` файл в `config.js` .
1. `config.js`Отредактируете файл и внести следующие изменения.
    1. `YOUR_APP_ID_HERE`Замените **ид приложения,** который вы получили с портала регистрации приложений.
1. В интерфейсе командной строки перейдите в этот каталог и запустите следующую команду, чтобы установить требования.

    ```Shell
    yarn install
    ```

## <a name="run-the-sample"></a>Запуск приложения

1. Чтобы запустить приложение, запустите следующую команду в CLI.

    ```Shell
    yarn start
    ```

1. В браузере перейдите в [Office.com](https://www.office.com/) и войдите. Выберите **"Создать"** на левой панели инструментов, а затем выберите **"Таблица".**

    ![Снимок экрана: меню "Создать" Office.com](/tutorial/images/office-select-excel.png)

1. Выберите **вкладку "Вставка"** и выберите **надстройки Office.**

1. Выберите **"Отправить мою надстройка"** и выберите **"Обзор".** Отправка **manifest.xml** файла.

1. Выберите **кнопку "Импорт календаря"** на **вкладке "Главная",** чтобы открыть ее.

    ![Снимок экрана с кнопкой "Импорт календаря" на вкладке "Главная"](/tutorial/images/get-started.png)
